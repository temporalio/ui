<script context="module" lang="ts">
  import type { LoadInput } from '@sveltejs/kit';
  import type { WorkflowExecution } from '$lib/models/workflow-execution';

  export async function load({ stuff, page }: LoadInput) {
    const { workflow, events } = stuff as {
      workflow: WorkflowExecution;
      events: HistoryEvent[];
    };
    const { namespace } = page.params;

    return {
      props: {
        workflow,
        events,
        namespace,
      },
    };
  }
</script>

<script lang="ts">
  import PendingActivities from './_pending-activities.svelte';
  import CodeBlock from '$lib/components/code-block.svelte';
  import Event from './_event.svelte';

  export let workflow: WorkflowExecution;
  export let events: HistoryEvent[];

  let format: EventFormat = 'grid';

  $: pendingActivities = workflow?.pendingActivities;
</script>

<div class="execution-information px-6 py-6">
  <div class="flex w-full mt-4">
    <PendingActivities activities={pendingActivities} />
  </div>
  <section>
    {#each events as event}
      <Event {event} />
    {/each}
  </section>
</div>
