import{S as V,i as O,s as j,w as v,k as q,e as E,x as T,m as P,c as R,a as C,d as $,y as S,g,q as h,o as d,B as y,N as W,a9 as B,l as D,ac as F,t as b,h as w,M as k,E as N,b as I,j as M}from"../../../../../../chunks/index-c85ade65.js";import{p as z}from"../../../../../../chunks/stores-2c13cc16.js";import{w as G}from"../../../../../../chunks/workflow-run-e923e8e5.js";import{b as Q}from"../../../../../../chunks/query-service-43861e5d.js";import{C as H}from"../../../../../../chunks/code-block-8a2b205f.js";import{B as J}from"../../../../../../chunks/button-e0b13963.js";import{E as A}from"../../../../../../chunks/empty-state-ebe0fe80.js";import{P as K}from"../../../../../../chunks/page-title-de4dcecc.js";import{L as U}from"../../../../../../chunks/loading-67332923.js";import{L as X}from"../../../../../../chunks/link-d95c4680.js";import"../../../../../../chunks/index-203c0d43.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/workflow-service-aa727209.js";import"../../../../../../chunks/simplify-attributes-6c8439d9.js";import"../../../../../../chunks/format-date-f8f72e15.js";import"../../../../../../chunks/to-duration-3f40f60b.js";import"../../../../../../chunks/is-18735aa3.js";import"../../../../../../chunks/route-for-api-6e5006a4.js";import"../../../../../../chunks/route-for-ef692dd7.js";import"../../../../../../chunks/notifications-9d24bb07.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/is-function-b969a126.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/index-c8da0ebb.js";import"../../../../../../chunks/copy-to-clipboard-b8e3d18c.js";import"../../../../../../chunks/badge-d2c94945.js";function Y(c){let e,r;return e=new A({props:{title:"No Stack Traces Found",dataCy:"query-stack-trace-empty",$$slots:{default:[te]},$$scope:{ctx:c}}}),{c(){v(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){S(e,t,n),r=!0},p(t,n){const s={};n&2048&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){r||(h(e.$$.fragment,t),r=!0)},o(t){d(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function Z(c){let e,r,t,n={ctx:c,current:null,token:null,hasCatch:!0,pending:oe,then:ne,catch:re,value:9,error:10,blocks:[,,,]};return B(r=c[1],n),{c(){e=D(),n.block.c()},l(s){e=D(),n.block.l(s)},m(s,a){g(s,e,a),n.block.m(s,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(s,a){c=s,n.ctx=c,a&2&&r!==(r=c[1])&&B(r,n)||F(n,c,a)},i(s){t||(h(n.block),t=!0)},o(s){for(let a=0;a<3;a+=1){const i=n.blocks[a];d(i)}t=!1},d(s){s&&$(e),n.block.d(s),n.token=null,n=null}}}function x(c){var m;let e,r,t,n,s=((m=c[3])==null?void 0:m.taskQueue)+"",a,i,u;return t=new X({props:{href:"https://docs.temporal.io/concepts/what-is-a-query/#stack-trace-query",$$slots:{default:[ee]},$$scope:{ctx:c}}}),{c(){e=E("p"),r=b("To enable "),v(t.$$.fragment),n=b(", run a Worker on the "),a=b(s),i=b(" Task Queue.")},l(f){e=R(f,"P",{});var o=C(e);r=w(o,"To enable "),T(t.$$.fragment,o),n=w(o,", run a Worker on the "),a=w(o,s),i=w(o," Task Queue."),o.forEach($)},m(f,o){g(f,e,o),k(e,r),S(t,e,null),k(e,n),k(e,a),k(e,i),u=!0},p(f,o){const l={};o&2048&&(l.$$scope={dirty:o,ctx:f}),t.$set(l)},i(f){u||(h(t.$$.fragment,f),u=!0)},o(f){d(t.$$.fragment,f),u=!1},d(f){f&&$(e),y(t)}}}function ee(c){let e;return{c(){e=b("stack traces")},l(r){e=w(r,"stack traces")},m(r,t){g(r,e,t)},d(r){r&&$(e)}}}function te(c){var n,s;let e,r,t=c[3].isRunning&&((s=(n=c[4])==null?void 0:n.pollers)==null?void 0:s.length)===0&&x(c);return{c(){t&&t.c(),e=D()},l(a){t&&t.l(a),e=D()},m(a,i){t&&t.m(a,i),g(a,e,i),r=!0},p(a,i){var u,m;a[3].isRunning&&((m=(u=a[4])==null?void 0:u.pollers)==null?void 0:m.length)===0&&t.p(a,i)},i(a){r||(h(t),r=!0)},o(a){d(t),r=!1},d(a){t&&t.d(a),a&&$(e)}}}function re(c){let e,r;return e=new A({props:{title:"An Error Occured",content:"Please make sure you have at least one worker running."}}),{c(){v(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){S(e,t,n),r=!0},p:N,i(t){r||(h(e.$$.fragment,t),r=!0)},o(t){d(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function ne(c){let e,r,t,n,s,a=c[0].toLocaleTimeString()+"",i,u,m,f,o;return r=new J({props:{iconScale:.8,icon:"refresh",loading:se,$$slots:{default:[ae]},$$scope:{ctx:c}}}),r.$on("click",c[5]),f=new H({props:{content:c[9],language:"text",dataCy:"query-stack-trace"}}),{c(){e=E("div"),v(r.$$.fragment),t=q(),n=E("p"),s=b("Stack Trace at "),i=b(a),u=q(),m=E("div"),v(f.$$.fragment),this.h()},l(l){e=R(l,"DIV",{class:!0});var p=C(e);T(r.$$.fragment,p),t=P(p),n=R(p,"P",{});var _=C(n);s=w(_,"Stack Trace at "),i=w(_,a),_.forEach($),p.forEach($),u=P(l),m=R(l,"DIV",{class:!0});var L=C(m);T(f.$$.fragment,L),L.forEach($),this.h()},h(){I(e,"class","flex items-center gap-4"),I(m,"class","flex items-start h-full")},m(l,p){g(l,e,p),S(r,e,null),k(e,t),k(e,n),k(n,s),k(n,i),g(l,u,p),g(l,m,p),S(f,m,null),o=!0},p(l,p){const _={};p&2048&&(_.$$scope={dirty:p,ctx:l}),r.$set(_),(!o||p&1)&&a!==(a=l[0].toLocaleTimeString()+"")&&M(i,a);const L={};p&2&&(L.content=l[9]),f.$set(L)},i(l){o||(h(r.$$.fragment,l),h(f.$$.fragment,l),o=!0)},o(l){d(r.$$.fragment,l),d(f.$$.fragment,l),o=!1},d(l){l&&$(e),y(r),l&&$(u),l&&$(m),y(f)}}}function ae(c){let e;return{c(){e=b("Refresh")},l(r){e=w(r,"Refresh")},m(r,t){g(r,e,t)},d(r){r&&$(e)}}}function oe(c){let e,r,t,n,s,a;return r=new U({}),{c(){e=E("div"),v(r.$$.fragment),t=q(),n=E("p"),s=b("(This will fail if you have no workers running.)"),this.h()},l(i){e=R(i,"DIV",{class:!0});var u=C(e);T(r.$$.fragment,u),t=P(u),n=R(u,"P",{});var m=C(n);s=w(m,"(This will fail if you have no workers running.)"),m.forEach($),u.forEach($),this.h()},h(){I(e,"class","text-center")},m(i,u){g(i,e,u),S(r,e,null),k(e,t),k(e,n),k(n,s),a=!0},p:N,i(i){a||(h(r.$$.fragment,i),a=!0)},o(i){d(r.$$.fragment,i),a=!1},d(i){i&&$(e),y(r)}}}function le(c){var f;let e,r,t,n,s,a;e=new K({props:{title:`Stack Trace | ${(f=c[2].params)==null?void 0:f.workflow}`,url:c[2].url.href}});const i=[Z,Y],u=[];function m(o,l){var p,_;return o[3].isRunning&&((_=(p=o[4])==null?void 0:p.pollers)==null?void 0:_.length)>0?0:1}return n=m(c),s=u[n]=i[n](c),{c(){v(e.$$.fragment),r=q(),t=E("section"),s.c()},l(o){T(e.$$.fragment,o),r=P(o),t=R(o,"SECTION",{});var l=C(t);s.l(l),l.forEach($)},m(o,l){S(e,o,l),g(o,r,l),g(o,t,l),u[n].m(t,null),a=!0},p(o,[l]){var _;const p={};l&4&&(p.title=`Stack Trace | ${(_=o[2].params)==null?void 0:_.workflow}`),l&4&&(p.url=o[2].url.href),e.$set(p),s.p(o,l)},i(o){a||(h(e.$$.fragment,o),h(s),a=!0)},o(o){d(e.$$.fragment,o),d(s),a=!1},d(o){y(e,o),o&&$(r),o&&$(t),u[n].d()}}}let se=!1;function ce(c,e,r){let t,n;W(c,G,l=>r(6,t=l)),W(c,z,l=>r(2,n=l));const{namespace:s}=n.params,{workflow:a,workers:i}=t;let u=new Date;const m=()=>Q({workflow:a,namespace:s});let f;const o=()=>{r(1,f=Q({workflow:a,namespace:s})),f.then(()=>{r(0,u=new Date)})};return a.isRunning&&r(1,f=m()),[u,f,n,a,i,o]}class ie extends V{constructor(e){super(),O(this,e,ce,le,j,{})}}function fe(c){let e,r;return e=new ie({}),{c(){v(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,n){S(e,t,n),r=!0},p:N,i(t){r||(h(e.$$.fragment,t),r=!0)},o(t){d(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}class Qe extends V{constructor(e){super(),O(this,e,null,fe,j,{})}}export{Qe as default};
