var Me=Object.defineProperty;var Te=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var Ae=(a,e,r)=>e in a?Me(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,pe=(a,e)=>{for(var r in e||(e={}))Be.call(e,r)&&Ae(a,r,e[r]);if(Te)for(var r of Te(e))Oe.call(e,r)&&Ae(a,r,e[r]);return a};import{S as X,i as Y,s as Z,I as de,e as $,c as g,a as v,d as c,g as A,J as we,K as _e,L as he,q as d,a3 as Ue,a4 as Je,o as w,a5 as Qe,w as y,k as P,x as I,m as j,y as E,B as T,l as Se,n as De,p as qe,t as R,h as F,b as p,M as m,E as ne,aa as We,T as ze,R as Ne,N as ee,C as Pe,V as je,j as ae}from"../../../../../../chunks/index-c85ade65.js";import{p as He}from"../../../../../../chunks/stores-2c13cc16.js";import{l as Ke,w as Ge}from"../../../../../../chunks/workflow-run-e923e8e5.js";import{f as Ce}from"../../../../../../chunks/index-39468d30.js";import{I as Xe}from"../../../../../../chunks/index-c8da0ebb.js";import{e as Ye}from"../../../../../../chunks/event-view-177e8eae.js";import{w as Ze}from"../../../../../../chunks/workflows-f021b637.js";import{t as xe}from"../../../../../../chunks/workflow-service-aa727209.js";import{g as Re,h as et,i as tt,j as rt,k as nt,l as Fe}from"../../../../../../chunks/route-for-ef692dd7.js";import{W as ot}from"../../../../../../chunks/workflow-status-2652a969.js";import{r as at,a as st,h as lt}from"../../../../../../chunks/route-for-api-6e5006a4.js";import{n as ft}from"../../../../../../chunks/notifications-9d24bb07.js";import{B as Le}from"../../../../../../chunks/button-e0b13963.js";import{M as it}from"../../../../../../chunks/modal-f5d552f6.js";import{f as ut}from"../../../../../../chunks/events-service-328baf97.js";import{L as ct}from"../../../../../../chunks/loading-67332923.js";import"../../../../../../chunks/index-203c0d43.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/persist-store-9b44ce28.js";import"../../../../../../chunks/is-function-b969a126.js";import"../../../../../../chunks/settings-3cc4c6ae.js";import"../../../../../../chunks/version-check-cead3852.js";import"../../../../../../chunks/is-18735aa3.js";import"../../../../../../chunks/simplify-attributes-6c8439d9.js";import"../../../../../../chunks/format-date-f8f72e15.js";import"../../../../../../chunks/to-duration-3f40f60b.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/badge-d2c94945.js";import"../../../../../../chunks/index-eb012da8.js";import"../../../../../../chunks/is-http-249a0663.js";import"../../../../../../chunks/data-converter-config-b3e1b826.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/get-event-categorization-732ccf42.js";import"../../../../../../chunks/has-038f0a2e.js";function mt(a){let e,r,t,o;const n=a[1].default,s=de(n,a,a[0],null);return{c(){e=$("div"),s&&s.c()},l(l){e=g(l,"DIV",{});var f=v(e);s&&s.l(f),f.forEach(c)},m(l,f){A(l,e,f),s&&s.m(e,null),o=!0},p(l,[f]){s&&s.p&&(!o||f&1)&&we(s,n,l,l[0],o?he(n,l[0],f,null):_e(l[0]),null)},i(l){o||(d(s,l),Ue(()=>{t&&t.end(1),r=Je(e,Ce,{y:-50,duration:150,delay:50}),r.start()}),o=!0)},o(l){w(s,l),r&&r.invalidate(),t=Qe(e,Ce,{y:-50,duration:150}),o=!1},d(l){l&&c(e),s&&s.d(l),l&&t&&t.end()}}}function pt(a,e,r){let{$$slots:t={},$$scope:o}=e;return a.$$set=n=>{"$$scope"in n&&r(0,o=n.$$scope)},[o,t]}class dt extends X{constructor(e){super(),Y(this,e,pt,mt,Z,{})}}async function wt({workflow:a,namespace:e,reason:r}){return await at(st("workflow.terminate",{namespace:e,workflowId:a.id,runId:a.runId}),{options:{method:"POST",body:JSON.stringify({reason:r})},shouldRetry:!1})}function Ve(a){let e,r,t,o;return e=new Le({props:{destroy:!0,$$slots:{default:[_t]},$$scope:{ctx:a}}}),e.$on("click",a[3]),t=new it({props:{open:a[2],confirmText:"Terminate",confirmType:"destroy",$$slots:{content:[$t],title:[ht]},$$scope:{ctx:a}}}),t.$on("cancelModal",a[4]),t.$on("confirmModal",a[6]),{c(){y(e.$$.fragment),r=P(),y(t.$$.fragment)},l(n){I(e.$$.fragment,n),r=j(n),I(t.$$.fragment,n)},m(n,s){E(e,n,s),A(n,r,s),E(t,n,s),o=!0},p(n,s){const l={};s&1024&&(l.$$scope={dirty:s,ctx:n}),e.$set(l);const f={};s&4&&(f.open=n[2]),s&1026&&(f.$$scope={dirty:s,ctx:n}),t.$set(f)},i(n){o||(d(e.$$.fragment,n),d(t.$$.fragment,n),o=!0)},o(n){w(e.$$.fragment,n),w(t.$$.fragment,n),o=!1},d(n){T(e,n),n&&c(r),T(t,n)}}}function _t(a){let e;return{c(){e=R("Terminate")},l(r){e=F(r,"Terminate")},m(r,t){A(r,e,t)},d(r){r&&c(e)}}}function ht(a){let e,r;return{c(){e=$("h3"),r=R("Terminate Workflow"),this.h()},l(t){e=g(t,"H3",{slot:!0});var o=v(e);r=F(o,"Terminate Workflow"),o.forEach(c),this.h()},h(){p(e,"slot","title")},m(t,o){A(t,e,o),m(e,r)},p:ne,d(t){t&&c(e)}}}function $t(a){let e,r,t,o,n,s,l;return{c(){e=$("div"),r=$("p"),t=R(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),o=P(),n=$("input"),this.h()},l(f){e=g(f,"DIV",{slot:!0});var i=v(e);r=g(i,"P",{});var _=v(r);t=F(_,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),_.forEach(c),o=j(i),n=g(i,"INPUT",{class:!0,placeholder:!0}),i.forEach(c),this.h()},h(){p(n,"class","mt-4 block w-full rounded-md border border-gray-200 p-2"),p(n,"placeholder","Enter a reason"),p(e,"slot","content")},m(f,i){A(f,e,i),m(e,r),m(r,t),m(e,o),m(e,n),We(n,a[1]),s||(l=ze(n,"input",a[8]),s=!0)},p(f,i){i&2&&n.value!==f[1]&&We(n,f[1])},d(f){f&&c(e),s=!1,l()}}}function gt(a){let e=a[5](a[0]),r,t,o=e&&Ve(a);return{c(){o&&o.c(),r=Se()},l(n){o&&o.l(n),r=Se()},m(n,s){o&&o.m(n,s),A(n,r,s),t=!0},p(n,[s]){s&1&&(e=n[5](n[0])),e?o?(o.p(n,s),s&1&&d(o,1)):(o=Ve(n),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(De(),w(o,1,1,()=>{o=null}),qe())},i(n){t||(d(o),t=!0)},o(n){w(o),t=!1},d(n){o&&o.d(n),n&&c(r)}}}function kt(a,e,r){let{workflow:t}=e,{namespace:o}=e,n="",s=!1;const l=()=>r(2,s=!0),f=()=>r(2,s=!1),i=k=>String(k.status)==="Running",_=()=>{r(2,s=!1),r(1,n=""),ft.add("success","Workflow Terminated"),window.location.reload()},S=()=>{wt({workflow:t,namespace:o,reason:n}).then(_).catch(lt)};function h(){n=this.value,r(1,n)}return a.$$set=k=>{"workflow"in k&&r(0,t=k.workflow),"namespace"in k&&r(7,o=k.namespace)},[t,n,s,l,f,i,S,o,h]}class bt extends X{constructor(e){super(),Y(this,e,kt,gt,Z,{workflow:0,namespace:7})}}function vt(a){let e,r;return{c(){e=$("span"),r=R("Download"),this.h()},l(t){e=g(t,"SPAN",{class:!0});var o=v(e);r=F(o,"Download"),o.forEach(c),this.h()},h(){p(e,"class","hidden md:inline")},m(t,o){A(t,e,o),m(e,r)},p:ne,d(t){t&&c(e)}}}function yt(a){let e,r;return e=new Le({props:{secondary:!0,icon:"download",$$slots:{default:[vt]},$$scope:{ctx:a}}}),e.$on("click",a[0]),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,o){E(e,t,o),r=!0},p(t,[o]){const n={};o&16&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function It(a,e,r){let{namespace:t}=e,{workflowId:o}=e,{runId:n}=e;const s=async()=>{const l=await ut({namespace:t,workflowId:o,runId:n,sort:"ascending"}),f=JSON.stringify({events:l},null,2);i(f,`${n}/events.json`,"text/plain");function i(_,S,h){const k=document.createElement("a"),O=new Blob([_],{type:h});k.href=URL.createObjectURL(O),k.download=S,k.click()}};return a.$$set=l=>{"namespace"in l&&r(1,t=l.namespace),"workflowId"in l&&r(2,o=l.workflowId),"runId"in l&&r(3,n=l.runId)},[s,t,o,n]}class Et extends X{constructor(e){super(),Y(this,e,It,yt,Z,{namespace:1,workflowId:2,runId:3})}}function Tt(a){let e;return{c(){e=R(a[1])},l(r){e=F(r,a[1])},m(r,t){A(r,e,t)},p(r,t){t&2&&ae(e,r[1])},d(r){r&&c(e)}}}function At(a){let e,r,t,o;return{c(){e=R(a[1]),r=P(),t=$("span"),o=R(a[2]),this.h()},l(n){e=F(n,a[1]),r=j(n),t=g(n,"SPAN",{class:!0});var s=v(t);o=F(s,a[2]),s.forEach(c),this.h()},h(){p(t,"class","rounded-sm bg-blue-100 px-2 text-blue-700")},m(n,s){A(n,e,s),A(n,r,s),A(n,t,s),m(t,o)},p(n,s){s&2&&ae(e,n[1]),s&4&&ae(o,n[2])},d(n){n&&c(e),n&&c(r),n&&c(t)}}}function St(a){let e,r;function t(s,l){return s[2]||s[2]===0?At:Tt}let o=t(a),n=o(a);return{c(){e=$("a"),n.c(),this.h()},l(s){e=g(s,"A",{class:!0,href:!0,"data-cy":!0});var l=v(e);n.l(l),l.forEach(c),this.h()},h(){p(e,"class","block whitespace-nowrap text-sm md:text-base svelte-sf1jtj"),p(e,"href",a[0]),p(e,"data-cy",r=a[4].dataCy),Ne(e,"active",a[3])},m(s,l){A(s,e,l),n.m(e,null)},p(s,[l]){o===(o=t(s))&&n?n.p(s,l):(n.d(1),n=o(s),n&&(n.c(),n.m(e,null))),l&1&&p(e,"href",s[0]),l&16&&r!==(r=s[4].dataCy)&&p(e,"data-cy",r),l&8&&Ne(e,"active",s[3])},i:ne,o:ne,d(s){s&&c(e),n.d()}}}function Wt(a,e,r){let t,o;ee(a,He,f=>r(5,o=f));let{href:n}=e,{label:s}=e,{amount:l=null}=e;return a.$$set=f=>{r(4,e=Pe(Pe({},e),je(f))),"href"in f&&r(0,n=f.href),"label"in f&&r(1,s=f.label),"amount"in f&&r(2,l=f.amount)},a.$$.update=()=>{a.$$.dirty&33&&r(3,t=o.url.pathname.includes(n))},e=je(e),[n,s,l,t,e,o]}class re extends X{constructor(e){super(),Y(this,e,Wt,St,Z,{href:0,label:1,amount:2})}}function Nt(a){var $e,ge,ke,be,ve;let e,r,t,o,n,s,l,f,i,_,S,h,k,O=a[1].id+"",oe,se,V,D,le,q,fe,W,H,ie,L,ue,M,ce,U,me,J,x;return n=new Xe({props:{scale:.8,name:"caretLeft",class:"inline"}}),S=new ot({props:{status:($e=a[1])==null?void 0:$e.status}}),D=new Et({props:{namespace:a[0],workflowId:a[1].id,runId:a[1].runId}}),q=new bt({props:{workflow:a[1],namespace:a[0]}}),H=new re({props:{label:"History",href:Re(pe({view:a[3]},a[4])),amount:(ge=a[1])==null?void 0:ge.historyEvents,dataCy:"history-tab"}}),L=new re({props:{label:"Workers",href:et(a[4]),amount:(be=(ke=a[2])==null?void 0:ke.pollers)==null?void 0:be.length,dataCy:"workers-tab"}}),M=new re({props:{label:"Pending Activities",href:tt(a[4]),amount:(ve=a[1].pendingActivities)==null?void 0:ve.length,dataCy:"pending-activities-tab"}}),U=new re({props:{label:"Stack Trace",href:rt(a[4]),dataCy:"stack-trace-tab"}}),J=new re({props:{label:"Queries",href:nt(a[4]),dataCy:"queries-tab"}}),{c(){e=$("header"),r=$("main"),t=$("div"),o=$("a"),y(n.$$.fragment),s=R("Back to Workflows"),f=P(),i=$("div"),_=$("h1"),y(S.$$.fragment),h=P(),k=$("span"),oe=R(O),se=P(),V=$("div"),y(D.$$.fragment),le=P(),y(q.$$.fragment),fe=P(),W=$("nav"),y(H.$$.fragment),ie=P(),y(L.$$.fragment),ue=P(),y(M.$$.fragment),ce=P(),y(U.$$.fragment),me=P(),y(J.$$.fragment),this.h()},l(u){e=g(u,"HEADER",{class:!0});var b=v(e);r=g(b,"MAIN",{class:!0});var C=v(r);t=g(C,"DIV",{class:!0});var Q=v(t);o=g(Q,"A",{href:!0,"data-cy":!0,class:!0});var z=v(o);I(n.$$.fragment,z),s=F(z,"Back to Workflows"),z.forEach(c),Q.forEach(c),f=j(C),i=g(C,"DIV",{class:!0});var B=v(i);_=g(B,"H1",{class:!0});var K=v(_);I(S.$$.fragment,K),h=j(K),k=g(K,"SPAN",{class:!0});var te=v(k);oe=F(te,O),te.forEach(c),K.forEach(c),se=j(B),V=g(B,"DIV",{class:!0});var G=v(V);I(D.$$.fragment,G),le=j(G),I(q.$$.fragment,G),G.forEach(c),B.forEach(c),fe=j(C),W=g(C,"NAV",{class:!0});var N=v(W);I(H.$$.fragment,N),ie=j(N),I(L.$$.fragment,N),ue=j(N),I(M.$$.fragment,N),ce=j(N),I(U.$$.fragment,N),me=j(N),I(J.$$.fragment,N),N.forEach(c),C.forEach(c),b.forEach(c),this.h()},h(){p(o,"href",l=`/namespaces/${a[0]}/workflows?query=${Fe(a[6])}&search=${a[5]}`),p(o,"data-cy","back-to-workflows"),p(o,"class","back-to-workflows svelte-st9g8m"),p(t,"class","-mt-3 -ml-2 block"),p(k,"class","select-all font-medium"),p(_,"class","relative flex items-center gap-4 text-2xl"),p(V,"class","ml-8 flex items-center justify-end gap-4"),p(i,"class","mb-8 flex items-center justify-between"),p(W,"class","flex flex-wrap gap-6"),p(r,"class","relative flex flex-col gap-1"),p(e,"class","mb-4 flex flex-col gap-4")},m(u,b){A(u,e,b),m(e,r),m(r,t),m(t,o),E(n,o,null),m(o,s),m(r,f),m(r,i),m(i,_),E(S,_,null),m(_,h),m(_,k),m(k,oe),m(i,se),m(i,V),E(D,V,null),m(V,le),E(q,V,null),m(r,fe),m(r,W),E(H,W,null),m(W,ie),E(L,W,null),m(W,ue),E(M,W,null),m(W,ce),E(U,W,null),m(W,me),E(J,W,null),x=!0},p(u,[b]){var G,N,ye,Ie,Ee;(!x||b&1&&l!==(l=`/namespaces/${u[0]}/workflows?query=${Fe(u[6])}&search=${u[5]}`))&&p(o,"href",l);const C={};b&2&&(C.status=(G=u[1])==null?void 0:G.status),S.$set(C),(!x||b&2)&&O!==(O=u[1].id+"")&&ae(oe,O);const Q={};b&1&&(Q.namespace=u[0]),b&2&&(Q.workflowId=u[1].id),b&2&&(Q.runId=u[1].runId),D.$set(Q);const z={};b&2&&(z.workflow=u[1]),b&1&&(z.namespace=u[0]),q.$set(z);const B={};b&8&&(B.href=Re(pe({view:u[3]},u[4]))),b&2&&(B.amount=(N=u[1])==null?void 0:N.historyEvents),H.$set(B);const K={};b&4&&(K.amount=(Ie=(ye=u[2])==null?void 0:ye.pollers)==null?void 0:Ie.length),L.$set(K);const te={};b&2&&(te.amount=(Ee=u[1].pendingActivities)==null?void 0:Ee.length),M.$set(te)},i(u){x||(d(n.$$.fragment,u),d(S.$$.fragment,u),d(D.$$.fragment,u),d(q.$$.fragment,u),d(H.$$.fragment,u),d(L.$$.fragment,u),d(M.$$.fragment,u),d(U.$$.fragment,u),d(J.$$.fragment,u),x=!0)},o(u){w(n.$$.fragment,u),w(S.$$.fragment,u),w(D.$$.fragment,u),w(q.$$.fragment,u),w(H.$$.fragment,u),w(L.$$.fragment,u),w(M.$$.fragment,u),w(U.$$.fragment,u),w(J.$$.fragment,u),x=!1},d(u){u&&c(e),T(n),T(S),T(D),T(q),T(H),T(L),T(M),T(U),T(J)}}}function Pt(a,e,r){let t,o;ee(a,Ze,h=>r(7,t=h)),ee(a,Ye,h=>r(3,o=h));let{namespace:n}=e,{workflow:s}=e,{workers:l}=e;const f={namespace:n,workflow:s.id,run:s.runId},{parameters:i,searchType:_}=t,S=xe(i);return a.$$set=h=>{"namespace"in h&&r(0,n=h.namespace),"workflow"in h&&r(1,s=h.workflow),"workers"in h&&r(2,l=h.workers)},[n,s,l,o,f,_,S]}class jt extends X{constructor(e){super(),Y(this,e,Pt,Nt,Z,{namespace:0,workflow:1,workers:2})}}function Ct(a){let e,r;return e=new dt({props:{$$slots:{default:[Ft]},$$scope:{ctx:a}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,o){E(e,t,o),r=!0},p(t,o){const n={};o&18&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Rt(a){let e,r;return e=new ct({}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,o){E(e,t,o),r=!0},p:ne,i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Ft(a){let e,r,t;e=new jt({props:{namespace:a[2],workflow:a[1].workflow,workers:a[1].workers}});const o=a[3].default,n=de(o,a,a[4],null);return{c(){y(e.$$.fragment),r=P(),n&&n.c()},l(s){I(e.$$.fragment,s),r=j(s),n&&n.l(s)},m(s,l){E(e,s,l),A(s,r,l),n&&n.m(s,l),t=!0},p(s,l){const f={};l&2&&(f.workflow=s[1].workflow),l&2&&(f.workers=s[1].workers),e.$set(f),n&&n.p&&(!t||l&16)&&we(n,o,s,s[4],t?he(o,s[4],l,null):_e(s[4]),null)},i(s){t||(d(e.$$.fragment,s),d(n,s),t=!0)},o(s){w(e.$$.fragment,s),w(n,s),t=!1},d(s){T(e,s),s&&c(r),n&&n.d(s)}}}function Vt(a){let e,r,t,o;const n=[Rt,Ct],s=[];function l(f,i){return f[0]?0:1}return r=l(a),t=s[r]=n[r](a),{c(){e=$("main"),t.c(),this.h()},l(f){e=g(f,"MAIN",{class:!0});var i=v(e);t.l(i),i.forEach(c),this.h()},h(){p(e,"class","flex h-full flex-col gap-6")},m(f,i){A(f,e,i),s[r].m(e,null),o=!0},p(f,[i]){let _=r;r=l(f),r===_?s[r].p(f,i):(De(),w(s[_],1,1,()=>{s[_]=null}),qe(),t=s[r],t?t.p(f,i):(t=s[r]=n[r](f),t.c()),d(t,1),t.m(e,null))},i(f){o||(d(t),o=!0)},o(f){w(t),o=!1},d(f){f&&c(e),s[r].d()}}}function Dt(a,e,r){let t,o,n;ee(a,He,i=>r(5,t=i)),ee(a,Ke,i=>r(0,o=i)),ee(a,Ge,i=>r(1,n=i));let{$$slots:s={},$$scope:l}=e;const{namespace:f}=t.params;return a.$$set=i=>{"$$scope"in i&&r(4,l=i.$$scope)},[o,n,f,s,l]}class qt extends X{constructor(e){super(),Y(this,e,Dt,Vt,Z,{})}}function Ht(a){let e;const r=a[0].default,t=de(r,a,a[1],null);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,n){t&&t.m(o,n),e=!0},p(o,n){t&&t.p&&(!e||n&2)&&we(t,r,o,o[1],e?he(r,o[1],n,null):_e(o[1]),null)},i(o){e||(d(t,o),e=!0)},o(o){w(t,o),e=!1},d(o){t&&t.d(o)}}}function Lt(a){let e,r;return e=new qt({props:{$$slots:{default:[Ht]},$$scope:{ctx:a}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,o){E(e,t,o),r=!0},p(t,[o]){const n={};o&2&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Mt(a,e,r){let{$$slots:t={},$$scope:o}=e;return a.$$set=n=>{"$$scope"in n&&r(1,o=n.$$scope)},[t,o]}class yr extends X{constructor(e){super(),Y(this,e,Mt,Lt,Z,{})}}export{yr as default};
