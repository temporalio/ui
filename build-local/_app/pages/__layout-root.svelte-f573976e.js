var ue=Object.defineProperty,ce=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var X=(o,e,n)=>e in o?ue(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,Y=(o,e)=>{for(var n in e||(e={}))de.call(e,n)&&X(o,n,e[n]);if(R)for(var n of R(e))_e.call(e,n)&&X(o,n,e[n]);return o},Z=(o,e)=>ce(o,me(e));import{X as pe,S as q,i as z,s as P,e as j,t as G,k as A,c as U,a as O,h as Q,d as v,m as D,b,Y as W,g as N,M as k,T as ve,j as ge,l as y,E as x,N as K,C as ee,V as ne,w as V,x as I,y as $,Z as F,q as g,o as h,B as E,_ as H,$ as M,n as he,p as be,I as we,J as ke,K as ye,L as Be}from"../chunks/index-c85ade65.js";import{g as Ve}from"../chunks/get-namespace-d07a8a35.js";import{n as Ie}from"../chunks/notifications-9d24bb07.js";import{r as oe,a as ie}from"../chunks/route-for-api-6e5006a4.js";import{c as $e,i as se}from"../chunks/version-check-cead3852.js";import{f as Ee,N as Ne,E as Ce}from"../chunks/error-boundary-1ad6d99f.js";import{f as Te}from"../chunks/settings-service-85bfdb0c.js";/* empty css                    */import je from"./_header.svelte-5a076fca.js";import{p as ae}from"../chunks/stores-2c13cc16.js";import{p as Ue}from"../chunks/persist-store-9b44ce28.js";import{P as Oe}from"../chunks/page-title-de4dcecc.js";import"../chunks/index-203c0d43.js";import"../chunks/route-for-ef692dd7.js";import"../chunks/is-network-error-ac7c8caf.js";import"../chunks/is-function-b969a126.js";import"../chunks/index-39468d30.js";import"../chunks/error-b75375ac.js";import"../chunks/navigation-6709cf39.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/link-d95c4680.js";import"../chunks/settings-3cc4c6ae.js";import"../chunks/index-c8da0ebb.js";import"../chunks/feature-tag-28e49b41.js";import"../chunks/feature-tag.svelte_svelte_type_style_lang-0f55e153.js";import"../chunks/nav-open-ad9d9abb.js";import"../chunks/_nav-row-f0b46b6f.js";import"../chunks/empty-state-ebe0fe80.js";import"../chunks/tooltip-0cd6d07a.js";import"../chunks/copyable-4c8a8b15.js";import"../chunks/copy-to-clipboard-b8e3d18c.js";import"../chunks/data-encoder-status-a3fb5b4a.js";import"../chunks/data-converter-config-b3e1b826.js";import"../chunks/is-http-249a0663.js";import"../chunks/modal-f5d552f6.js";import"../chunks/button-e0b13963.js";import"../chunks/badge-d2c94945.js";import"../chunks/namespaces-04ab41f4.js";const Le=(o,e)=>!o.auth.enabled||Boolean(e==null?void 0:e.email),Ae=async(o=fetch)=>{const e=await o("https://api.github.com/repos/temporalio/ui-server/releases"),n=await e.json();if(!e.ok)return;let t;if(n.length>0){const{tag_name:r}=n[0];t=r.replace("v","")}return t},te={namespaces:[]};async function De(o,e=fetch){if(o.runtimeEnvironment.isCloud)return te;const n=await oe(ie("namespaces"),{request:e,onError:()=>Ie.add("error","Unable to fetch namespaces")});return n!=null?n:te}const qe=async(o,e=fetch)=>{if(!o.runtimeEnvironment.isCloud)return await oe(ie("cluster"),{request:e}).then(n=>($e.set(n),n))};var S=(o=>(o[o.TemporalVersion=1]="TemporalVersion",o[o.UIVersion=2]="UIVersion",o))(S||{});const J=Ue("closedBanners",null),ze=o=>{var n;let e=(n=pe(J))!=null?n:[];e=[...e,o],e=e.slice(e.length-10,e.length),J.set(e)};function re(o){let e,n,t,r,s,i,a,l,f,u;return{c(){e=j("section"),n=j("a"),t=G(o[2]),r=A(),s=j("button"),i=G("\u2715"),this.h()},l(c){e=U(c,"SECTION",{class:!0,"data-cy":!0});var d=O(e);n=U(d,"A",{href:!0,target:!0});var _=O(n);t=Q(_,o[2]),_.forEach(v),r=D(d),s=U(d,"BUTTON",{class:!0,"data-cy":!0});var w=O(s);i=Q(w,"\u2715"),w.forEach(v),d.forEach(v),this.h()},h(){b(n,"href",o[3]),b(n,"target","_blank"),b(s,"class","text-black-600 absolute top-0 right-0 mr-5"),b(s,"data-cy","close-banner"),b(e,"class",a=W(`relative block text-center leading-10 ${o[1]}`)+" svelte-1xgik0j"),b(e,"data-cy",l=o[5].dataCy)},m(c,d){N(c,e,d),k(e,n),k(n,t),k(e,r),k(e,s),k(s,i),f||(u=ve(s,"click",o[8]),f=!0)},p(c,d){d&4&&ge(t,c[2]),d&8&&b(n,"href",c[3]),d&2&&a!==(a=W(`relative block text-center leading-10 ${c[1]}`)+" svelte-1xgik0j")&&b(e,"class",a),d&32&&l!==(l=c[5].dataCy)&&b(e,"data-cy",l)},d(c){c&&v(e),f=!1,u()}}}function Pe(o){let e,n=o[4]&&re(o);return{c(){n&&n.c(),e=y()},l(t){n&&n.l(t),e=y()},m(t,r){n&&n.m(t,r),N(t,e,r)},p(t,[r]){t[4]?n?n.p(t,r):(n=re(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:x,o:x,d(t){n&&n.d(t),t&&v(e)}}}function Se(o,e,n){let t,r;K(o,J,c=>n(7,r=c));let{key:s}=e,{severity:i}=e,{message:a}=e,{link:l}=e,{shownBanner:f}=e;const u=()=>ze(s);return o.$$set=c=>{n(5,e=ee(ee({},e),ne(c))),"key"in c&&n(0,s=c.key),"severity"in c&&n(1,i=c.severity),"message"in c&&n(2,a=c.message),"link"in c&&n(3,l=c.link),"shownBanner"in c&&n(6,f=c.shownBanner)},o.$$.update=()=>{o.$$.dirty&129&&n(4,t=!(r!=null?r:[]).includes(s)),o.$$.dirty&80&&(t||n(6,f++,f))},e=ne(e),[s,i,a,l,t,e,f,r,u]}class le extends q{constructor(e){super(),z(this,e,Se,Pe,P,{key:0,severity:1,message:2,link:3,shownBanner:6})}}function Fe(o){let e,n,t;function r(i){o[6](i)}let s={key:o[2],severity:o[1],message:o[5],link:o[3],dataCy:"temporal-version-banner"};return o[0]!==void 0&&(s.shownBanner=o[0]),e=new le({props:s}),H.push(()=>M(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&1&&(n=!0,l.shownBanner=i[0],F(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function He(o){let e,n,t=o[4]&&Fe(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[4]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}function Me(o,e,n){let t;K(o,ae,L=>n(12,t=L));var r,s,i,a,l;let{shownBanner:f}=e;const{cluster:u}=t.stuff,c={High:"high",Medium:"medium",Low:"low"},{recommended:d,current:_}=(r=u==null?void 0:u.versionInfo)!==null&&r!==void 0?r:{},w=(i=(s=u==null?void 0:u.versionInfo)===null||s===void 0?void 0:s.alerts)===null||i===void 0?void 0:i[0],m=w?c[w.severity]:c.Low,p=`server-v${_==null?void 0:_.version}`,C=`https://github.com/temporalio/temporal/releases/tag/v${(l=(a=u==null?void 0:u.versionInfo)===null||a===void 0?void 0:a.recommended)===null||l===void 0?void 0:l.version}`,B=se(d==null?void 0:d.version,_==null?void 0:_.version),T=m===c.Low?`\u{1F4E5} Temporal v${d==null?void 0:d.version} is available`:`\u{1F4E5} ${w==null?void 0:w.message}`;function fe(L){f=L,n(0,f)}return o.$$set=L=>{"shownBanner"in L&&n(0,f=L.shownBanner)},[f,m,p,C,B,T,fe]}class Je extends q{constructor(e){super(),z(this,e,Me,He,P,{shownBanner:0})}}function Ke(o){let e,n,t;function r(i){o[6](i)}let s={key:o[1],severity:Xe,message:o[2],link:o[4],dataCy:"ui-version-banner"};return o[0]!==void 0&&(s.shownBanner=o[0]),e=new le({props:s}),H.push(()=>M(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&1&&(n=!0,l.shownBanner=i[0],F(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function Re(o){let e,n,t=o[3]&&Ke(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[3]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}const Xe="low";function Ye(o,e,n){let{shownBanner:t}=e,{uiVersionInfo:r}=e;const s=`ui-v${r==null?void 0:r.current}`,i=`\u{1F4E5} Temporal UI v${r==null?void 0:r.recommended} is available`,a=se(r==null?void 0:r.recommended,r==null?void 0:r.current),l=`https://github.com/temporalio/ui-server/releases/tag/v${r==null?void 0:r.recommended}`;function f(u){t=u,n(0,t)}return o.$$set=u=>{"shownBanner"in u&&n(0,t=u.shownBanner),"uiVersionInfo"in u&&n(5,r=u.uiVersionInfo)},[t,s,i,a,l,r,f]}class Ze extends q{constructor(e){super(),z(this,e,Ye,Re,P,{shownBanner:0,uiVersionInfo:5})}}function Ge(o){let e,n,t,r;const s=[We,Qe],i=[];function a(l,f){return l[1]===S.TemporalVersion?0:l[1]===S.UIVersion?1:-1}return~(e=a(o))&&(n=i[e]=s[e](o)),{c(){n&&n.c(),t=y()},l(l){n&&n.l(l),t=y()},m(l,f){~e&&i[e].m(l,f),N(l,t,f),r=!0},p(l,f){let u=e;e=a(l),e===u?~e&&i[e].p(l,f):(n&&(he(),h(i[u],1,1,()=>{i[u]=null}),be()),~e?(n=i[e],n?n.p(l,f):(n=i[e]=s[e](l),n.c()),g(n,1),n.m(t.parentNode,t)):n=null)},i(l){r||(g(n),r=!0)},o(l){h(n),r=!1},d(l){~e&&i[e].d(l),l&&v(t)}}}function Qe(o){let e,n,t;function r(i){o[4](i)}let s={uiVersionInfo:o[0]};return o[1]!==void 0&&(s.shownBanner=o[1]),e=new Ze({props:s}),H.push(()=>M(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};a&1&&(l.uiVersionInfo=i[0]),!n&&a&2&&(n=!0,l.shownBanner=i[1],F(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function We(o){let e,n,t;function r(i){o[3](i)}let s={};return o[1]!==void 0&&(s.shownBanner=o[1]),e=new Je({props:s}),H.push(()=>M(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&2&&(n=!0,l.shownBanner=i[1],F(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function xe(o){let e,n,t=o[2]&&Ge(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[2]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}function en(o,e,n){let t;K(o,ae,f=>n(5,t=f));let{uiVersionInfo:r}=e,s=S.TemporalVersion;const i=t.stuff.settings.notifyOnNewVersion;function a(f){s=f,n(1,s)}function l(f){s=f,n(1,s)}return o.$$set=f=>{"uiVersionInfo"in f&&n(0,r=f.uiVersionInfo)},[r,s,i,a,l]}class nn extends q{constructor(e){super(),z(this,e,en,xe,P,{uiVersionInfo:0})}}function tn(o){let e;const n=o[2].default,t=we(n,o,o[3],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&8)&&ke(t,n,r,r[3],e?Be(n,r[3],s,null):ye(r[3]),null)},i(r){e||(g(t,r),e=!0)},o(r){h(t,r),e=!1},d(r){t&&t.d(r)}}}function rn(o){let e,n,t,r,s,i,a,l,f,u,c,d,_,w;return e=new Oe({}),r=new Ne({}),a=new je({props:{user:o[0]}}),u=new nn({props:{uiVersionInfo:o[1]}}),_=new Ce({props:{onError:on,$$slots:{default:[tn]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment),n=A(),t=j("div"),V(r.$$.fragment),s=A(),i=j("div"),V(a.$$.fragment),l=A(),f=j("section"),V(u.$$.fragment),c=A(),d=j("div"),V(_.$$.fragment),this.h()},l(m){I(e.$$.fragment,m),n=D(m),t=U(m,"DIV",{class:!0});var p=O(t);I(r.$$.fragment,p),s=D(p),i=U(p,"DIV",{class:!0});var C=O(i);I(a.$$.fragment,C),C.forEach(v),l=D(p),f=U(p,"SECTION",{id:!0,class:!0});var B=O(f);I(u.$$.fragment,B),c=D(B),d=U(B,"DIV",{class:!0});var T=O(d);I(_.$$.fragment,T),T.forEach(v),B.forEach(v),p.forEach(v),this.h()},h(){b(i,"class","sticky top-0 z-20 h-screen w-auto"),b(d,"class","z-10 flex h-full flex-col gap-4 px-10 pb-10 pt-8"),b(f,"id","content"),b(f,"class","h-screen w-max flex-auto overflow-auto"),b(t,"class","flex h-screen w-screen flex-row")},m(m,p){$(e,m,p),N(m,n,p),N(m,t,p),$(r,t,null),k(t,s),k(t,i),$(a,i,null),k(t,l),k(t,f),$(u,f,null),k(f,c),k(f,d),$(_,d,null),w=!0},p(m,[p]){const C={};p&1&&(C.user=m[0]),a.$set(C);const B={};p&2&&(B.uiVersionInfo=m[1]),u.$set(B);const T={};p&8&&(T.$$scope={dirty:p,ctx:m}),_.$set(T)},i(m){w||(g(e.$$.fragment,m),g(r.$$.fragment,m),g(a.$$.fragment,m),g(u.$$.fragment,m),g(_.$$.fragment,m),w=!0)},o(m){h(e.$$.fragment,m),h(r.$$.fragment,m),h(a.$$.fragment,m),h(u.$$.fragment,m),h(_.$$.fragment,m),w=!1},d(m){E(e,m),m&&v(n),m&&v(t),E(r),E(a),E(u),E(_)}}}const Rn=async function({fetch:o}){const e=await Te(o),n=await Ee(o);if(!Le(e,n))return{status:302,redirect:"/login"};const t=await De(e,o),r=Ve({namespaces:t==null?void 0:t.namespaces,settings:e}),s=await qe(e,o),i={current:e.version,recommended:e.notifyOnNewVersion?await Ae(o):void 0};return{props:{user:n,uiVersionInfo:i},stuff:{namespaces:t==null?void 0:t.namespaces,settings:Z(Y({},e),{defaultNamespace:r}),cluster:s}}},on=()=>{};function sn(o,e,n){let{$$slots:t={},$$scope:r}=e,{user:s}=e,{uiVersionInfo:i}=e;return o.$$set=a=>{"user"in a&&n(0,s=a.user),"uiVersionInfo"in a&&n(1,i=a.uiVersionInfo),"$$scope"in a&&n(3,r=a.$$scope)},[s,i,t,r]}class Xn extends q{constructor(e){super(),z(this,e,sn,rn,P,{user:0,uiVersionInfo:1})}}export{Xn as default,Rn as load};
