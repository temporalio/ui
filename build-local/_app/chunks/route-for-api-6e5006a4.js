var F=Object.defineProperty;var g=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var I=(o,n,c)=>n in o?F(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c,d=(o,n)=>{for(var c in n||(n={}))P.call(n,c)&&I(o,c,n[c]);if(g)for(var c of g(n))R.call(n,c)&&I(o,c,n[c]);return o};import{b as T,e as y,t as O}from"./route-for-ef692dd7.js";import{w as B}from"./index-203c0d43.js";import{n as k}from"./notifications-9d24bb07.js";import{i as $}from"./is-network-error-ac7c8caf.js";import{i as L}from"./is-function-b969a126.js";const N=B(null),S=o=>{if(_(o)&&T){window.location.assign(y());return}if(z(o)&&T){window.location.assign(y());return}if($(o))throw k.add("error",`${o.statusCode} ${o.statusText}`),N.set(o),o;typeof o=="string"&&k.add("error",o),o instanceof Error&&k.add("error",o.message)},_=o=>$(o)?o.statusCode===401:!1,z=o=>$(o)?o.statusCode===403:!1,m=o=>o.message!==void 0&&typeof o.message=="string",W=async(o,n={},c=10)=>{var t;const{params:l={},request:f=fetch,token:w,shouldRetry:v=!1,notifyOnError:C=!0,onError:h,retryInterval:b=5e3}=n;let{options:s}=n;const q=w?{next_page_token:w}:{},A=new URLSearchParams(d(d({},l),q)),U=O(o,A);try{s=j(s),globalThis!=null&&globalThis.AccessToken&&(s.headers=await H(s==null?void 0:s.headers,globalThis.AccessToken));const i=await f(U,s),u=await i.json(),{status:x,statusText:E}=i;if(!i.ok)if(h&&L(h))h({status:x,statusText:E,body:u});else throw{statusCode:i.status,statusText:i.statusText,response:i,message:(t=u==null?void 0:u.message)!=null?t:i.statusText};return u}catch(i){if(C){if(S(i),v&&c>0)return new Promise(u=>{setTimeout(()=>{u(W(o,n,c-1))},b)})}else throw i}},j=o=>{const n=d({credentials:"include"},o);return n.headers=K(o==null?void 0:o.headers),n},H=async(o,n)=>{o||(o={});try{const c=await n();c&&(o.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return o},K=o=>{o||(o={});const n="_csrf=",c="X-CSRF-TOKEN";try{let f=document.cookie.split(";").find(w=>w.includes(n));f&&!o[c]&&(f=f.trim().slice(n.length),o[c]=f)}catch(l){console.error(l)}return o},X=(o,n)=>o.replace("%namespace%",n),D=o=>{var c;let n="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&o?n=X(globalThis.AppConfig.apiUrl,o):n="http://localhost:8080",n.endsWith("/")&&(n=n.slice(0,-1)),n},G=(o,n)=>(o.startsWith("/")&&(o=o.slice(1)),`${D(n)}/api/v1/${o}`),J=o=>Object.keys(o!=null?o:{}).reduce((n,c)=>(n[c]=encodeURIComponent(encodeURIComponent(o[c])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function p(o,n,c=!0){c&&(n=J(n));const l={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,"events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`};return G(l[o],n==null?void 0:n.namespace)}export{p as a,S as h,m as i,N as n,W as r};
